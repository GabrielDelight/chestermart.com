"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[947],{1607:(e,s,r)=>{r.d(s,{Z:()=>t});var a=r(2791),o=r(6871),l=r(872),n=r(9866);const i="ProfileStyles_main__OBJ23";var d=r(184);const t=e=>{let{children:s}=e;const r=(0,o.s0)(),t=localStorage.getItem("token"),c=(e=>{if(!e||"undefined"===e)return void r("/login");const s=JSON.parse(atob(e.split(".")[1]));return Math.floor(Date.now()/1e3)>=s.exp})(t);return(0,a.useEffect)((()=>{c&&alert("Session has expired"),(c||!t||t.length<1)&&r("/login")}),[c]),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(l.Z,{}),(0,d.jsxs)("main",{className:i,children:[(0,d.jsx)("aside",{children:(0,d.jsx)(n.Z,{})}),(0,d.jsx)("article",{children:s})]})]})}},6947:(e,s,r)=>{r.r(s),r.d(s,{default:()=>p});var a=r(2791),o=r(1607);const l={form_title:"Profile_form_title__+13Ia",form_row:"Profile_form_row__lKATq",form:"Profile_form__ZAAq6",form_list:"Profile_form_list__SSSjl",error:"Profile_error__yL-KE"};var n=r(5705),i=r(8007),d=r(2189),t=r(1830),c=r.n(t),m=r(184);const h=i.Ry().shape({firstname:i.Z_().min(2,"Too Short!").max(50,"Too Long!").required("Please enter your first name"),lastname:i.Z_().min(2,"Too Short!").max(50,"Too Long!").required("Please eneter your last name"),email:i.Z_().email("Invalid email address").required("Your valid email is required"),dob:i.hT().required("Date of Birth is required").max(new Date,"Date of Birth cannot be in the future").min(new Date(1900,0,1),"Date of Birth cannot be before 1900"),phoneNumber:i.Z_().min(2,"Too Short!").max(190,"Too Long!").required("Phone number is required")}),u=i.Ry().shape({oldPassword:i.Z_().min(8).matches(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/,"Password must contain at least 8 characters, one uppercase letter, one lowercase letter, one number, and one special character.").required("Password is required"),password:i.Z_().min(8).matches(/^(?=.*?[A-Z])(?=.*?[a-z])(?=.*?[0-9])(?=.*?[#?!@$%^&*-]).{8,}$/,"Password must contain at least 8 characters, one uppercase letter, one lowercase letter, one number, and one special character.").required("Password is required"),confirmPassword:i.Z_().min(8,"Confirm password must be 8 characters long").oneOf([i.iH("password")],"Password did not match").required("Confirm password is required")});const p=function(){const[e]=(0,d.f9)(),{data:s={},refetch:r}=(0,d.$L)("/user");let[i,t]=(0,a.useState)(1);return(0,a.useEffect)((()=>{if(r(),null!==s&&void 0!==s&&s._id){let e=setTimeout((()=>{t(Math.random())}),100);return()=>clearTimeout(e)}}),[null===s||void 0===s?void 0:s._id]),console.log(s.dob),(0,m.jsxs)(o.Z,{children:[(0,m.jsx)(n.J9,{initialValues:{firstname:s.firstname,lastname:s.lastname,email:s.email,dob:s.dob,phoneNumber:s.phoneNumber},onSubmit:s=>{e({url:"/account-update",body:{...s}}).unwrap().then((e=>{console.log(e),c().fire({icon:"success",text:e.message})})).catch((e=>{console.log(e),c().fire({icon:"error",title:"Oops...",text:e.data.message})}))},validationSchema:h,children:e=>{let{handleChange:s,handleSubmit:r,setFieldTouched:a,touched:o,isValid:n,values:i,errors:d}=e;return(0,m.jsx)(m.Fragment,{children:(0,m.jsxs)("div",{className:l.form,children:[(0,m.jsx)("h1",{children:"Profile Information"}),(0,m.jsx)("br",{}),(0,m.jsxs)("div",{className:l.form_row,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"",children:"First Name"}),(0,m.jsx)("input",{type:"text",placeholder:"John",value:i.firstname,onChange:s("firstname")}),o.firstname&&d.firstname&&(0,m.jsx)("p",{className:l.error,children:d.firstname})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"",children:"Last Name"}),(0,m.jsx)("input",{type:"text",placeholder:"Smith",value:i.lastname,onChange:s("lastname")}),o.lastname&&d.lastname&&(0,m.jsx)("p",{className:l.error,children:d.lastname})]})]}),(0,m.jsxs)("div",{className:l.form_row,children:[(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"",children:"D.O.B"}),(0,m.jsx)("input",{type:"date",value:i.dob,onChange:s("dob")}),o.dob&&d.dob&&(0,m.jsx)("p",{className:l.error,children:d.dob})]}),(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"",children:"Phone number"}),(0,m.jsx)("input",{type:"number",placeholder:"+123 456 789",value:i.phoneNumber,onChange:s("phoneNumber")}),o.phoneNumber&&d.phoneNumber&&(0,m.jsx)("p",{className:l.error,children:d.phoneNumber})]})]}),(0,m.jsx)("div",{className:l.form_list,children:(0,m.jsxs)("div",{children:[(0,m.jsx)("label",{htmlFor:"",children:"E-mail Address"}),(0,m.jsx)("input",{type:"email",disabled:!0,placeholder:"johnsmith@email.com",value:i.email,onChange:s("email")}),o.email&&d.email&&(0,m.jsx)("p",{className:l.error,children:d.email})]})}),(0,m.jsx)("div",{className:l.form_list,children:(0,m.jsx)("button",{type:"button",onClick:()=>r(),children:"Save Changes"})})]})})}},i),(0,m.jsx)("br",{}),(0,m.jsx)(n.J9,{initialValues:{password:"",oldPassword:"",confirmPassword:""},onSubmit:s=>{e({url:"/change-password",body:{oldPassword:s.oldPassword,password:s.password,confirmPassword:s.confirmPassword}}).unwrap().then((e=>{console.log(e),c().fire({icon:"success",text:e.message})})).catch((e=>{console.log(e),c().fire({icon:"error",title:"Oops...",text:e.data.message})}))},validationSchema:u,children:e=>{let{handleChange:s,handleSubmit:r,setFieldTouched:a,touched:o,isValid:n,values:i,errors:d}=e;return(0,m.jsx)("div",{className:l.main,children:(0,m.jsx)("div",{className:l.wrapper,children:(0,m.jsxs)("div",{className:l.form,children:[(0,m.jsx)("p",{className:l.form_title,children:"Change Password"}),(0,m.jsx)("p",{style:{fontSize:12,marginTop:-10},children:"Please enter a stronger password"}),(0,m.jsx)("br",{}),(0,m.jsxs)("div",{className:l.form_list,children:[(0,m.jsx)("label",{htmlFor:"",children:"Old password"}),(0,m.jsx)("input",{type:"password",placeholder:"Enter your old password",name:"password",value:i.oldPassword,onChange:s("oldPassword")}),o.oldPassword&&d.oldPassword&&(0,m.jsx)("p",{className:l.error,children:d.oldPassword})]}),(0,m.jsxs)("div",{className:l.form_list,children:[(0,m.jsx)("label",{htmlFor:"",children:"Password"}),(0,m.jsx)("input",{type:"password",placeholder:"Enter your password",name:"password",value:i.password,onChange:s("password")}),o.password&&d.password&&(0,m.jsx)("p",{className:l.error,children:d.password})]}),(0,m.jsxs)("div",{className:l.form_list,children:[(0,m.jsx)("label",{htmlFor:"",children:"Confirm Password"}),(0,m.jsx)("input",{type:"password",placeholder:"Confirm  password",name:"confirmPassword",value:i.confirmPassword,onChange:s("confirmPassword")}),o.confirmPassword&&d.confirmPassword&&(0,m.jsx)("p",{className:l.error,children:d.confirmPassword})]}),(0,m.jsx)("div",{className:l.form_list,children:(0,m.jsx)("button",{onClick:()=>r(),children:"Change password"})})]})})})}})]})}}}]);
//# sourceMappingURL=947.a43a0a82.chunk.js.map